(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{BDmK:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return b})),a.d(t,"default",(function(){return m}));var n=a("Fcif"),r=a("+I+c"),o=(a("mXGw"),a("/FXl")),i=a("TjRS"),l=a("+8zC"),c=(a("aD51"),["components"]),b={};void 0!==b&&b&&b===Object(b)&&Object.isExtensible(b)&&!b.hasOwnProperty("__filemeta")&&Object.defineProperty(b,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/cookbook/ios-avplayer-recording.mdx"}});var p={_frontmatter:b},s=i.a;function m(e){var t=e.components,a=Object(r.a)(e,c);return Object(o.b)(s,Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)(l.l,{mdxType:"Title"},"iOS technical note: AVPlayer recording"),Object(o.b)(l.k,{kind:"important",mdxType:"TextBlock"},"\nThis guide applies to all frameworks that create or generate iOS applications.\n"),Object(o.b)("p",null,"Support for recording video from ",Object(o.b)("inlineCode",{parentName:"p"},"AVPlayerLayer")," or camera preview via ",Object(o.b)("inlineCode",{parentName:"p"},"AVCaptureVideoPreviewLayer")," is not currently available."),Object(o.b)("h2",{id:"symptoms"},"Symptoms"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"When user plays video with ",Object(o.b)("inlineCode",{parentName:"p"},"AVPlayer")," in layer or in ",Object(o.b)("inlineCode",{parentName:"p"},"AVPlayerViewController"),", ",Object(o.b)("b",null,"the video is not recorded and the background (video content) is black"),".")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"All camera previews are black (without content)."))),Object(o.b)("h2",{id:"technical-reasons"},"Technical reasons"),Object(o.b)("p",null,"Both layers use low-level API that serves data to these layers via pixel buffers. Graphic data from ",Object(o.b)("inlineCode",{parentName:"p"},"AVFoundation")," are processed directly on-device GPU with hardware support, not in ",Object(o.b)("inlineCode",{parentName:"p"},"Core Graphics")," framework like other GUI parts. For us are these low-level layers inaccessible."),Object(o.b)(l.k,{kind:"note",mdxType:"TextBlock"},"\n`AVPlayer` recording failure is obviously an architectural problem that has not been solved by Apple for a long time. Their own `ReplayKit` framework behaves exactly the same, and Apple itself points this out in the documentation.\n\nIn general, using the camera preview does not mean that the recording is not working. \nFor example, in `ARKit` we do not have problems because internally uses `MetalKit`. "),Object(o.b)("h2",{id:"recommendations"},"Recommendations"),Object(o.b)("h3",{id:"camera-preview"},"Camera preview"),Object(o.b)("p",null,"Do not use ",Object(o.b)("inlineCode",{parentName:"p"},"AVCaptureVideoPreviewLayer")," to render the data from the device camera. "),Object(o.b)("p",null,"Instead, use ",Object(o.b)("inlineCode",{parentName:"p"},"MTKView")," (",Object(o.b)("inlineCode",{parentName:"p"},"MetalKit"),") to preview the camera. Such a solution works, and it does not seem to have any performance impacts."),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://navoshta.com/metal-camera-part-1-camera-session/"},"More details and sample implementation")),Object(o.b)("h3",{id:"video-playback"},"Video playback"),Object(o.b)("p",null,"We don't have any recommended solution yet."))}void 0!==m&&m&&m===Object(m)&&Object.isExtensible(m)&&!m.hasOwnProperty("__filemeta")&&Object.defineProperty(m,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/cookbook/ios-avplayer-recording.mdx"}}),m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-cookbook-ios-avplayer-recording-mdx-b608e6efc7f01efbe3e4.js.map