(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{ap0l:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n("Fcif"),r=n("+I+c"),o=(n("mXGw"),n("/FXl")),l=n("TjRS"),b=n("+8zC"),i=(n("aD51"),["components"]),c={};void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!Object.prototype.hasOwnProperty.call(c,"__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/relay-proxy/index.mdx"}});var p={_frontmatter:c},m=l.a;function s(e){var t=e.components,n=Object(r.a)(e,i);return Object(o.b)(m,Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)(b.l,{mdxType:"Title"},"Smartlook Relay Proxy"),Object(o.b)("p",null,"This service relays HTTP requests from your subdomain to\nSmartlook's recording domains, allowing you to bypass potential browser settings or extensions used by your visitors configured to limit data capture."),Object(o.b)(b.k,{kind:"important",mdxType:"TextBlock"},"Only web recording is currently supported."),Object(o.b)("h2",{id:"environment-variables"},"Environment variables"),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",{parentName:"tr",align:null},"Name"),Object(o.b)("th",{parentName:"tr",align:null},"Type"),Object(o.b)("th",{parentName:"tr",align:null},"Default value"),Object(o.b)("th",{parentName:"tr",align:null},"Description"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"LOGGER_LEVEL")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"string")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"'info'")),Object(o.b)("td",{parentName:"tr",align:null},"One of ",Object(o.b)("inlineCode",{parentName:"td"},"trace"),", ",Object(o.b)("inlineCode",{parentName:"td"},"debug"),", ",Object(o.b)("inlineCode",{parentName:"td"},"info"),", ",Object(o.b)("inlineCode",{parentName:"td"},"warn"),", ",Object(o.b)("inlineCode",{parentName:"td"},"error"),", ",Object(o.b)("inlineCode",{parentName:"td"},"fatal"),", ",Object(o.b)("inlineCode",{parentName:"td"},"silent"))),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"MANAGER_HOST")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"string")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"'https://manager.eu.smartlook.cloud'")),Object(o.b)("td",{parentName:"tr",align:null},"Smartlook Manager host")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"WEB_SDK_WRITER_HOST")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"string")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"'https://web-writer.eu.smartlook.cloud'")),Object(o.b)("td",{parentName:"tr",align:null},"Smartlook Web Writer host")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"ASSETS_PROXY_HOST")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"string")),Object(o.b)("td",{parentName:"tr",align:null},Object(o.b)("inlineCode",{parentName:"td"},"'https://assets-proxy.smartlook.cloud'")),Object(o.b)("td",{parentName:"tr",align:null},"Smartlook Assets Proxy host")))),Object(o.b)("h2",{id:"installation-and-deployment"},"Installation and deployment"),Object(o.b)("p",null,"Image is available on ",Object(o.b)("a",{parentName:"p",href:"https://hub.docker.com/r/smartlook/relay-proxy"},"Docker Hub"),"."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Run the image and configure environment variables according to your needs.",Object(o.b)("br",{parentName:"li"}),Object(o.b)("strong",{parentName:"li"},"All variables are optional, default values are listed in the table above"),".")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-bash"},'docker run --name="smartlook-relay-proxy" -d \\\n  # can be also set with "--env-file"\n  -e LOGGER_LEVEL=<level> \\\n  -e MANAGER_HOST=<host> \\\n  -e WEB_SDK_WRITER_HOST=<host> \\\n  -e ASSETS_PROXY_HOST=<host> \\\n  -p <port>:8000 \\  # mapping is optional, internally runs on port 8000\n  smartlook/relay-proxy:latest\n')),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Create a new subdomain (e.g. ",Object(o.b)("em",{parentName:"p"},"sl.yourdomain.com"),") and point it to the container.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Replace URLs in Smartlook script (",Object(o.b)("strong",{parentName:"p"},"only next-gen tracking code is supported"),")."))),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-html"},"<script>\n    window.smartlook ||\n      (function (d) {\n      var o = (smartlook = function () {\n        o.api.push(arguments)\n      }), h = d.getElementsByTagName('head')[0];\n      var c = d.createElement('script');\n      o.api = new Array();\n      c.async = true;\n      c.crossOrigin = 'anonymous';\n      c.type = 'text/javascript';\n      c.charset = 'utf-8';\n      c.src = 'https://<your-relay-proxy-host>/recorder.js';\n      h.appendChild(c);\n    })(document);\n    smartlook('init', <project-key>, { host: '<your-relay-proxy-host>' });\n<\/script>\n")),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},"You're done! Visit your site and check the network tab to make sure the requests are sent through your subdomain.\n",Object(o.b)("img",{alt:"network tab screenshot",src:"https://raw.githubusercontent.com/smartlook/smartlook-relay-proxy/main/network.png"}))),Object(o.b)("h2",{id:"development"},"Development"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-sh"},"# See all available commands\nmake help\n\n# Build and start development server (port 80 by default)\n# Do not forget to configure environment variables in docker-compose.dev.yml\nmake dev # add `build=yes` for rebuild\n")),Object(o.b)("h2",{id:"license"},"License"),Object(o.b)("p",null,"See ",Object(o.b)("a",{parentName:"p",href:"https://raw.githubusercontent.com/smartlook/smartlook-relay-proxy/main/LICENSE"},"LICENSE"),"."))}void 0!==s&&s&&s===Object(s)&&Object.isExtensible(s)&&!Object.prototype.hasOwnProperty.call(s,"__filemeta")&&Object.defineProperty(s,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/relay-proxy/index.mdx"}}),s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-relay-proxy-index-mdx-5f2b98d4a40a7e8ad72b.js.map